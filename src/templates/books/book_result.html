{% extends 'base.html' %}

{% block content %}


{% for book in results %}
<div class="card mb-2" style="margin-left:10%; margin-right:10%;">
  <div class="card-body p-3" >
    <div class="row">
      <div class="col-2">
          <img src="{{ book.image }}" class="center">
      </div>

        <div class="col-10">
            <div class="row mb-3">
              <div class="col-6">
                <p><strong class="text-muted">{{ book.title }}</strong></p>
                <small class="text-muted">{{ book.author }}</small>
                  <br>
              </div>
                <div class="col-6" style="text-align:right;">
                <small class="text-muted">ID: {{ book.id }}</small>
                </div>
            </div>

            {% if book.description == None %}
            There is no description :(
            {% else %}
            {{ book.description }}
            {% endif %}
            {{ book.user }}
            <p>
                 <br>
            {% if user.books_added.all %}
                {% for user_book in user.books_added.all %}
                    {% ifequal book.id|stringformat:"s" user_book.id|stringformat:"s" %}
                         <div type="text/css" class = "container"></div>
                        <a class="likebutton btn btn-danger btn-lg" id="like{{ book.id }}" href="#" data-catid="{{ book.id }}">Delete</a>
                        </p><p id="message{{book.id}}"></p>
                        </div>
                    {% else %}
                        <div type="text/css" class = "container"></div>
                        <a class="likebutton btn btn-primary btn-lg" id="like{{ book.id }}" href="#" data-catid="{{ book.id }}">Add</a>
                        </p><p id="message{{book.id}}"></p>
                        </div>
                    {% endifequal %}
                {% endfor %}
            {% else %}
                <div type="text/css" class = "container"></div>
                <a class="likebutton btn btn-primary btn-lg" id="like{{ book.id }}" href="#" data-catid="{{ book.id }}">Add</a>
                </p><p id="message{{book.id}}"></p>
                </div>
            {% endif %}


<!--                <input id="add" href="" type="Submit" value="Add Book">-->
<!--                <a class="btn btn-primary btn-lg right" id="add" href="{{ add_book }}" role="button">Add</a>-->

            </p>
        </div>
    </div>
  </div>
</div>

{% endfor %}

                <script type="text/javascript">
                    $('.likebutton').click(function(){
                    var id;
                    id = $(this).attr("data-catid");
                    $.ajax(
                    {
                        type:"GET",
                        url: "book_add_view",
                        data:{
                                 book_id: id
                    },
                    success: function( data )
                    {
                        if( $( '#like'+ id ).hasClass( "btn btn-primary btn-lg" ) )
                        {
                        $( '#like'+ id ).removeClass('btn btn-primary btn-lg');
                        $( '#like'+ id ).addClass('btn btn-danger btn-lg');
                        }
                        if( $( '#like'+ id ).hasClass( "btn btn-danger btn-lg" ) )
                        {
                        $( '#like'+ id ).removeClass('btn btn-danger btn-lg');
                        $( '#like'+ id ).addClass('btn btn-primary btn-lg');
                        }
                     }
                     })
                     });
                </script>

{% endblock %}