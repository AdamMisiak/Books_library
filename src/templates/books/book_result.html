{% extends 'base.html' %}

{% block content %}


{% for book in results %}
<div class="card mb-2" style="margin-left:10%; margin-right:10%;">
  <div class="card-body p-3" >
    <div class="row">
      <div class="col-2">
          <img src="{{ book.image }}" class="center">
      </div>

        <div class="col-10">
            <div class="row mb-3">
              <div class="col-6">
                <p><strong class="text-muted">{{ book.title }}</strong></p>
                <small class="text-muted">{{ book.author }}</small>
                  <br>
              </div>
                <div class="col-6" style="text-align:right;">
                <small class="text-muted">ID: {{ book.id }}</small>
                </div>
            </div>

            {% if book.description == None %}
            There is no description :(
            {% else %}
            {{ book.description }}
            {% endif %}
            {{ book.user }}
            <p>
                 <br>

                <form action="{% url 'books:book_add' %}" method="POST" class="ui form">
                    {% csrf_token %}
                    <input type="hidden" name="book_id" value="{{ book.id }}">
                    <input type="hidden" name="book_title" value="{{ book.title }}">
                    <input type="hidden" name="book_author" value="{{ book.author }}">
                    <input type="hidden" name="book_image" value="{{ book.image }}">
                    <input type="hidden" name="book_description" value="{{ book.description }}">


                    {% if user not in book_position %}
                        <button id="add" type="submit">Add</button>
                    {% else %}
                        <button id="delete" type="submit">Delete</button>
                    {% endif %}
                </form>

            <div type="text/css" class = "container"></div>
            <a class="likebutton btn btn-primary btn-lg" id="like{{ book.id }}" href="#" data-catid="{{ book.id }}">Like</a>
            </p><p id="message{{book.id}}"></p>
            </div>


<!--                <input id="add" href="" type="Submit" value="Add Book">-->
<!--                <a class="btn btn-primary btn-lg right" id="add" href="{{ add_book }}" role="button">Add</a>-->

            </p>
        </div>
    </div>
  </div>
</div>

{% endfor %}

                <script type="text/javascript">
                    $('.likebutton').click(function(){
                    var id;
                    id = $(this).attr("data-catid");
                    $.ajax(
                    {
                        type:"GET",
                        url: "like",
                        data:{
                                 book_id: id
                    },
                    success: function( data )
                    {
                        $( '#like'+ id ).removeClass('btn btn-primary btn-lg');
                        $( '#like'+ id ).addClass('btn btn-success btn-lg'); } }) });
                </script>

{% endblock %}